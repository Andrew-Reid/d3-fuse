!function(t,u){"object"==typeof exports&&"undefined"!=typeof module?u(exports,require("d3-quadtree")):"function"==typeof define&&define.amd?define(["exports","d3-quadtree"],u):u(t.d3=t.d3||{},t.d3)}(this,function(t,u){"use strict";var n=function(t){return"function"==typeof t?t:function(){return t}};t.fuse=function(t){var o=t||[],a=0,r=Math.PI,e=function(t){return t.x},y=function(t){return t.y},l=function(t){return t.r},i=function(t){return l(t)*l(t)*Math.PI};function f(){return s(),function t(){c()&&t()}(),o}function c(){for(var t,n=u.quadtree(o,function(t){return t.layout.x},function(t){return t.layout.y}).visitAfter(d),e=0,y=0;y<o.length;++y)t=o[y],n.visit(l);function l(u,n,o,y,l){var i=u.data,f=u.r+t.layout.r;if(!(i&&i.index>t.index&&i.layout.a&&t.layout.a))return n>t.layout.x+f||y<t.layout.x-f||o>t.layout.y+f||l<t.layout.y-f;var c,d,s=t.layout.x-i.layout.x,x=t.layout.y-i.layout.y;Math.sqrt(s*s+x*x)<f+a&&(e++,i.layout.a>t.layout.a?(c=i,d=t):(c=t,d=i),c.layout.x=(c.layout.x*c.layout.a+d.layout.x*d.layout.a)/(c.layout.a+d.layout.a),c.layout.y=(c.layout.y*c.layout.a+d.layout.y*d.layout.a)/(d.layout.a+c.layout.a),c.layout.count+=d.layout.count,c.layout.a+=d.layout.a,c.layout.r=Math.sqrt(c.layout.a/r),d.layout.r=d.layout.a=0,c.layout.children.push(d),d.layout.parent=c)}return e}function d(t){if(t.data)return t.r=t.data.layout.r;for(var u=t.r=0;u<4;++u)t[u]&&t[u].r>t.r&&(t.r=t[u].r)}function s(){for(var t,u=0,n=o.length;u<n;++u)(t=o[u]).index=u,t.layout={x:e(t)+1e-6*(Math.random()-.5),y:y(t),a:i(t),r:l(t),count:1,children:[],parent:{}}}return f.nodes=function(t){return arguments.length?(o=t,f):o},f.padding=function(t){return arguments.length?(a=t,f):a},f.radius=function(t){return arguments.length?(l=n(t),f):l},f.area=function(t){return arguments.length?(i=n(t),f):i},f.x=function(t){return e=n(t),f},f.y=function(t){return y=n(t),f},f.defuse=function(){return o.forEach(function(t){delete t.layout}),f},f.step=function(){return s(),c(),f},f.fuse=function(){return f(),f},f},Object.defineProperty(t,"__esModule",{value:!0})});
